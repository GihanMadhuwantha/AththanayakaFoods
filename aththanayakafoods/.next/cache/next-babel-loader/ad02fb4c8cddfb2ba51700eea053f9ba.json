{"ast":null,"code":"import connectDB from '../../../utils/connectDB';\nimport Products from '../../../models/productModel';\nimport auth from '../../../middleware/auth';\nconnectDB();\nexport default (async (req, res) => {\n  switch (req.method) {\n    case \"GET\":\n      await getProducts(req, res);\n      break;\n    case \"POST\":\n      await createProduct(req, res);\n      break;\n  }\n});\nconst getProducts = async (req, res) => {\n  try {\n    const products = await Products.find();\n    res.json({\n      status: 'success',\n      result: products.length,\n      products\n    });\n  } catch (err) {\n    return res.status(500).json({\n      err: err.message\n    });\n  }\n};\nconst createProduct = async (req, res) => {\n  try {\n    const result = await auth(req, res);\n    if (result.role !== 'admin') return res.status(400).json({\n      err: 'Authentication is not valid.'\n    });\n    const {\n      title,\n      price,\n      inStock,\n      description,\n      content,\n      category,\n      images\n    } = req.body;\n    if (!title || !price || !inStock || !description || !content || category === 'all' || images.length === 0) return res.status(400).json({\n      err: 'Please add all the fields.'\n    });\n    const newProduct = new Products({\n      title: title.toLowerCase(),\n      price,\n      inStock,\n      description,\n      content,\n      category,\n      images\n    });\n    await newProduct.save();\n    res.json({\n      msg: 'Success! Created a new product'\n    });\n  } catch (err) {\n    return res.status(500).json({\n      err: err.message\n    });\n  }\n};","map":{"version":3,"names":["connectDB","Products","auth","req","res","method","getProducts","createProduct","products","find","json","status","result","length","err","message","role","title","price","inStock","description","content","category","images","body","newProduct","toLowerCase","save","msg"],"sources":["C:/Users/gihanmadhuwantha/Desktop/system_Development/AththanayakaFoods/aththanayakafoods/pages/api/product/index.js"],"sourcesContent":["import connectDB from '../../../utils/connectDB'\r\nimport Products from '../../../models/productModel'\r\nimport auth from '../../../middleware/auth'\r\n\r\nconnectDB()\r\nexport default async(req,res)=>{\r\n switch(req.method){\r\n    case \"GET\":\r\n        await getProducts(req,res)\r\n        break;\r\n        case \"POST\":\r\n         await createProduct(req, res)\r\n         break;\r\n\r\n }\r\n\r\n}\r\nconst getProducts= async(req,res)=>{\r\n try {\r\n    const products=await Products.find()\r\n    res.json({\r\n        status:'success',\r\n        result:products.length,\r\n        products})\r\n } catch (err) {\r\n    return res.status(500).json({err:err.message })\r\n }\r\n}\r\nconst createProduct = async (req, res) => {\r\n   try {\r\n       const result = await auth(req, res)\r\n       if(result.role !== 'admin') return res.status(400).json({err: 'Authentication is not valid.'})\r\n\r\n       const {title, price, inStock, description, content, category, images} = req.body\r\n\r\n       if(!title || !price || !inStock || !description || !content || category === 'all' || images.length === 0)\r\n       return res.status(400).json({err: 'Please add all the fields.'})\r\n\r\n\r\n       const newProduct = new Products({\r\n           title: title.toLowerCase(), price, inStock, description, content, category, images\r\n       })\r\n\r\n       await newProduct.save()\r\n\r\n       res.json({msg: 'Success! Created a new product'})\r\n\r\n   } catch (err) {\r\n       return res.status(500).json({err: err.message})\r\n   }\r\n}"],"mappings":"AAAA,OAAOA,SAAS,MAAM,0BAA0B;AAChD,OAAOC,QAAQ,MAAM,8BAA8B;AACnD,OAAOC,IAAI,MAAM,0BAA0B;AAE3CF,SAAS,EAAE;AACX,gBAAe,OAAMG,GAAG,EAACC,GAAG,KAAG;EAC9B,QAAOD,GAAG,CAACE,MAAM;IACd,KAAK,KAAK;MACN,MAAMC,WAAW,CAACH,GAAG,EAACC,GAAG,CAAC;MAC1B;IACA,KAAK,MAAM;MACV,MAAMG,aAAa,CAACJ,GAAG,EAAEC,GAAG,CAAC;MAC7B;EAAM;AAIf,CAAC;AACD,MAAME,WAAW,GAAE,OAAMH,GAAG,EAACC,GAAG,KAAG;EAClC,IAAI;IACD,MAAMI,QAAQ,GAAC,MAAMP,QAAQ,CAACQ,IAAI,EAAE;IACpCL,GAAG,CAACM,IAAI,CAAC;MACLC,MAAM,EAAC,SAAS;MAChBC,MAAM,EAACJ,QAAQ,CAACK,MAAM;MACtBL;IAAQ,CAAC,CAAC;EACjB,CAAC,CAAC,OAAOM,GAAG,EAAE;IACX,OAAOV,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC;MAACI,GAAG,EAACA,GAAG,CAACC;IAAQ,CAAC,CAAC;EAClD;AACD,CAAC;AACD,MAAMR,aAAa,GAAG,OAAOJ,GAAG,EAAEC,GAAG,KAAK;EACvC,IAAI;IACA,MAAMQ,MAAM,GAAG,MAAMV,IAAI,CAACC,GAAG,EAAEC,GAAG,CAAC;IACnC,IAAGQ,MAAM,CAACI,IAAI,KAAK,OAAO,EAAE,OAAOZ,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC;MAACI,GAAG,EAAE;IAA8B,CAAC,CAAC;IAE9F,MAAM;MAACG,KAAK;MAAEC,KAAK;MAAEC,OAAO;MAAEC,WAAW;MAAEC,OAAO;MAAEC,QAAQ;MAAEC;IAAM,CAAC,GAAGpB,GAAG,CAACqB,IAAI;IAEhF,IAAG,CAACP,KAAK,IAAI,CAACC,KAAK,IAAI,CAACC,OAAO,IAAI,CAACC,WAAW,IAAI,CAACC,OAAO,IAAIC,QAAQ,KAAK,KAAK,IAAIC,MAAM,CAACV,MAAM,KAAK,CAAC,EACxG,OAAOT,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC;MAACI,GAAG,EAAE;IAA4B,CAAC,CAAC;IAGhE,MAAMW,UAAU,GAAG,IAAIxB,QAAQ,CAAC;MAC5BgB,KAAK,EAAEA,KAAK,CAACS,WAAW,EAAE;MAAER,KAAK;MAAEC,OAAO;MAAEC,WAAW;MAAEC,OAAO;MAAEC,QAAQ;MAAEC;IAChF,CAAC,CAAC;IAEF,MAAME,UAAU,CAACE,IAAI,EAAE;IAEvBvB,GAAG,CAACM,IAAI,CAAC;MAACkB,GAAG,EAAE;IAAgC,CAAC,CAAC;EAErD,CAAC,CAAC,OAAOd,GAAG,EAAE;IACV,OAAOV,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC;MAACI,GAAG,EAAEA,GAAG,CAACC;IAAO,CAAC,CAAC;EACnD;AACH,CAAC"},"metadata":{},"sourceType":"module"}