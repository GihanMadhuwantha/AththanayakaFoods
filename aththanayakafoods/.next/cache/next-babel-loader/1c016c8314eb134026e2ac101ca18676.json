{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\gihanmadhuwantha\\\\Desktop\\\\system_Development\\\\AththanayakaFoods\\\\aththanayakafoods\\\\pages\\\\paypalBtn.js\",\n  _this = this,\n  _s = $RefreshSig$();\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport { useEffect, useRef, useContext } from 'react';\nimport { patchData } from '../utils/fetchData';\nimport { DataContext } from '../store/GlobalState';\nimport { updateItem } from '../store/Actions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar paypalBtn = function paypalBtn(_ref) {\n  _s();\n  var total = _ref.total,\n    address = _ref.address,\n    mobile = _ref.mobile,\n    state = _ref.state,\n    dispatch = _ref.dispatch;\n  var refPaypalBtn = useRef();\n  var _useEffect = useEffect(function () {\n      paypal.Buttons({\n        createOrder: function createOrder(data, actions) {\n          // This function sets up the details of the transaction, including the amount and line item details.\n          return actions.order.create({\n            purchase_units: [{\n              amount: {\n                value: '0.01'\n              }\n            }]\n          });\n        },\n        onApprove: function onApprove(data, actions) {\n          // This function captures the funds from the transaction.\n          dispatch({\n            type: 'NOTIFY',\n            payload: {\n              loading: true\n            }\n          });\n          return actions.order.capture().then(function (details) {\n            patchData(\"order/payment/\".concat(order._id), {\n              paymentId: details.payer.payer_id\n            }, auth.token).then(function (res) {\n              if (res.err) return dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  error: res.err\n                }\n              });\n              dispatch(updateItem(orders, order._id, _objectSpread(_objectSpread({}, order), {}, {\n                paid: true,\n                dateOfPayment: details.create_time,\n                paymentId: details.payer.payer_id,\n                method: 'Paypal'\n              }), 'ADD_ORDERS'));\n              return dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  success: res.msg\n                }\n              });\n            });\n            // This function shows a transaction success message to your buyer.\n          });\n        }\n      }).render(refPaypalBtn.current);\n    }, []),\n    cart = _useEffect.cart,\n    auth = _useEffect.auth;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: refPaypalBtn\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 9\n  }, _this);\n};\n_s(paypalBtn, \"dzrqFE8eCOxh0k8tOCmCv22tM/A=\");\nexport default paypalBtn;","map":{"version":3,"names":["useEffect","useRef","useContext","patchData","DataContext","updateItem","paypalBtn","total","address","mobile","state","dispatch","refPaypalBtn","paypal","Buttons","createOrder","data","actions","order","create","purchase_units","amount","value","onApprove","type","payload","loading","capture","then","details","_id","paymentId","payer","payer_id","auth","token","res","err","error","orders","paid","dateOfPayment","create_time","method","success","msg","render","current","cart"],"sources":["C:/Users/gihanmadhuwantha/Desktop/system_Development/AththanayakaFoods/aththanayakafoods/pages/paypalBtn.js"],"sourcesContent":["import { useEffect, useRef, useContext } from 'react'\r\nimport { patchData } from '../utils/fetchData'\r\nimport {DataContext} from '../store/GlobalState'\r\nimport {updateItem} from '../store/Actions'\r\n\r\nconst paypalBtn = ({total,address,mobile,state,dispatch}) => {\r\n    const refPaypalBtn = useRef()\r\n    const{cart,auth}=\r\n    useEffect(() => {\r\n      paypal.Buttons({\r\n          createOrder: function(data, actions) {\r\n            // This function sets up the details of the transaction, including the amount and line item details.\r\n            return actions.order.create({\r\n              purchase_units: [{\r\n                amount: {\r\n                  value: '0.01'\r\n                }\r\n              }]\r\n            });\r\n          },\r\n          onApprove: function(data, actions) {\r\n            // This function captures the funds from the transaction.\r\n            dispatch({ type: 'NOTIFY', payload: {loading: true} })\r\n\r\n            return actions.order.capture().then(function(details) {\r\n\r\n              patchData(`order/payment/${order._id}`, { \r\n                paymentId: details.payer.payer_id\r\n              }, auth.token)\r\n              .then(res => {\r\n                if(res.err) return dispatch({ type: 'NOTIFY', payload: {error: res.err} })\r\n                \r\n                dispatch(updateItem(orders, order._id, {\r\n                  ...order, \r\n                  paid: true, dateOfPayment: details.create_time,\r\n                  paymentId: details.payer.payer_id, method: 'Paypal'\r\n                }, 'ADD_ORDERS'))\r\n\r\n                return dispatch({ type: 'NOTIFY', payload: {success: res.msg} })\r\n              })\r\n              // This function shows a transaction success message to your buyer.\r\n            });\r\n          }\r\n      }).render(refPaypalBtn.current);\r\n  },[])\r\n    return(\r\n        <div ref={refPaypalBtn}></div>\r\n    )\r\n    \r\n    }\r\nexport default paypalBtn "],"mappings":";;;;;;AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,UAAU,QAAQ,OAAO;AACrD,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,SAAQC,WAAW,QAAO,sBAAsB;AAChD,SAAQC,UAAU,QAAO,kBAAkB;AAAA;AAE3C,IAAMC,SAAS,GAAG,SAAZA,SAAS,OAA8C;EAAA;EAAA,IAAzCC,KAAK,QAALA,KAAK;IAACC,OAAO,QAAPA,OAAO;IAACC,MAAM,QAANA,MAAM;IAACC,KAAK,QAALA,KAAK;IAACC,QAAQ,QAARA,QAAQ;EACnD,IAAMC,YAAY,GAAGX,MAAM,EAAE;EAC7B,iBACAD,SAAS,CAAC,YAAM;MACda,MAAM,CAACC,OAAO,CAAC;QACXC,WAAW,EAAE,qBAASC,IAAI,EAAEC,OAAO,EAAE;UACnC;UACA,OAAOA,OAAO,CAACC,KAAK,CAACC,MAAM,CAAC;YAC1BC,cAAc,EAAE,CAAC;cACfC,MAAM,EAAE;gBACNC,KAAK,EAAE;cACT;YACF,CAAC;UACH,CAAC,CAAC;QACJ,CAAC;QACDC,SAAS,EAAE,mBAASP,IAAI,EAAEC,OAAO,EAAE;UACjC;UACAN,QAAQ,CAAC;YAAEa,IAAI,EAAE,QAAQ;YAAEC,OAAO,EAAE;cAACC,OAAO,EAAE;YAAI;UAAE,CAAC,CAAC;UAEtD,OAAOT,OAAO,CAACC,KAAK,CAACS,OAAO,EAAE,CAACC,IAAI,CAAC,UAASC,OAAO,EAAE;YAEpD1B,SAAS,yBAAkBe,KAAK,CAACY,GAAG,GAAI;cACtCC,SAAS,EAAEF,OAAO,CAACG,KAAK,CAACC;YAC3B,CAAC,EAAEC,IAAI,CAACC,KAAK,CAAC,CACbP,IAAI,CAAC,UAAAQ,GAAG,EAAI;cACX,IAAGA,GAAG,CAACC,GAAG,EAAE,OAAO1B,QAAQ,CAAC;gBAAEa,IAAI,EAAE,QAAQ;gBAAEC,OAAO,EAAE;kBAACa,KAAK,EAAEF,GAAG,CAACC;gBAAG;cAAE,CAAC,CAAC;cAE1E1B,QAAQ,CAACN,UAAU,CAACkC,MAAM,EAAErB,KAAK,CAACY,GAAG,kCAChCZ,KAAK;gBACRsB,IAAI,EAAE,IAAI;gBAAEC,aAAa,EAAEZ,OAAO,CAACa,WAAW;gBAC9CX,SAAS,EAAEF,OAAO,CAACG,KAAK,CAACC,QAAQ;gBAAEU,MAAM,EAAE;cAAQ,IAClD,YAAY,CAAC,CAAC;cAEjB,OAAOhC,QAAQ,CAAC;gBAAEa,IAAI,EAAE,QAAQ;gBAAEC,OAAO,EAAE;kBAACmB,OAAO,EAAER,GAAG,CAACS;gBAAG;cAAE,CAAC,CAAC;YAClE,CAAC,CAAC;YACF;UACF,CAAC,CAAC;QACJ;MACJ,CAAC,CAAC,CAACC,MAAM,CAAClC,YAAY,CAACmC,OAAO,CAAC;IACnC,CAAC,EAAC,EAAE,CAAC;IArCGC,IAAI,cAAJA,IAAI;IAACd,IAAI,cAAJA,IAAI;EAsCf,oBACI;IAAK,GAAG,EAAEtB;EAAa;IAAA;IAAA;IAAA;EAAA,SAAO;AAGlC,CAAC;AAAA,GA5CCN,SAAS;AA6Cf,eAAeA,SAAS"},"metadata":{},"sourceType":"module"}